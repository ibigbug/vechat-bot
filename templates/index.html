<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Vechat Sync Bot</title>
  <script>
    function logout() {
      document.cookie.split(';').forEach(cookie => {
        var eqi = cookie.indexOf('=')
        var name = eqi > -1 ? cookie.substr(0, eqi) : cookie
        document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT';
      })
      location.reload()
    }
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/6.0.0/normalize.min.css"></link>
  <style>
    form {
      display: inline;
    }
  </style>
</head>
<body>
{{ if not .user }}
  <a href="/account/login">Login with Google</a>
{{ else }}
  <p>Hi, {{ .user.Email }},  <a href="#" onclick="logout()">Logout</a></p>
  <h3>My Channels</h3>
  {{ range .channels }}
    {{ . }}
  {{ else }}
    No channel, for now. Create one now.
  {{ end }}

  <h3>My Telegram Bots</h3>
  <form action="/telegram" method="POST">
    <input type="text" name="bot_name" placeholder="Telegram Bot Name">
    <input type="text" name="bot_token" placeholder="Telegram Bot Token">
    <button>Submit</button>
  </form>
  <dl>
    {{ range .tgbots }}
      <dt>{{ .Name }}</dt>
      <dd>- status: {{ .Status }}</dd>
      <dd>
        - action:
          <form action="/telegram/toggle?id={{ .Id }}" method="POST"><button>toggle</button></form>
          <a href="/wechat?bot={{ .Id }}"><button>link to wechat</button></a>
      </dd>
  {{ else }}
    No Bots. Click to create new one.
  {{ end }}
  </dl>
{{ end }}


</body>
</html>